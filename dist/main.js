function doPost(t){}function doPostMessages(){}(()=>{"use strict";var t={};t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}();var e="https://docs.google.com/spreadsheets/d/1jX5alq9OvY_wykZID51iWf11ewd3impyJ8vyJRA41AY/edit",o=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","AA","AB","AC","AD","AE","AF","AG","AH","AI","AJ","AK","AL","AM","AN","AO","AP","AQ","AR","AS","AT","AU","AV","AW","AX","AY","AZ","BA","BB","BC","BD","BE","BF","BG","BH","BI","BJ","BK","BL","BM","BN","BO","BP","BQ","BR","BS","BT","BU","BV","BW","BX","BY","BZ","CA","CB","CC","CD","CE","CF","CG","CH","CI","CJ","CK","CL","CM","CN","CO","CP","CQ","CR","CS","CT","CU","CV","CW","CX","CY","CZ"],n=function(){function t(t,e){this.book=SpreadsheetApp.openByUrl(t),this.sheetName=e,this.sheet=this.book.getSheetByName(e)}return t.prototype._isBlankRow=function(t){var e=!0;return t.forEach((function(t){""!==t&&(e=!1)})),e},t.prototype._blankRowDel=function(t){var e=this;return t?t.filter((function(t){return!e._isBlankRow(t)})):null},t.prototype._blankColDel=function(t){return t?t.filter((function(t){return""!==t})):null},t.prototype.doGetLastRow=function(t,e){if(!(t<1&&e<1)){var n=o[e-1];return this.doReadSSVerString("".concat(n).concat(t,":").concat(n,"1000")).length<2?t+1:this.sheet.getRange(t,e).getNextDataCell(SpreadsheetApp.Direction.DOWN).getRow()+1}},t.prototype.doGetLastCol=function(t,e){if(!(t<1&&e<1)){var n=o[e-1],s=o[o.length-1],r=this.doReadSSVerString("".concat(n).concat(t,":").concat(s).concat(t));return this._blankColDel(r[0]).length<2?e+1:this.sheet.getRange(t,e).getNextDataCell(SpreadsheetApp.Direction.NEXT).getColumn()+1}},t.prototype.doWriteSS=function(t,e,o){e&&o&&(t||(t=""),this.sheet.getRange(e,o).setValue(t))},t.prototype.doReadSSVerString=function(t,e){void 0===e&&(e=!1);var o=null;return t?(o=this.sheet.getRange(t).getValues(),e?o:this._blankRowDel(o)):o},t.prototype.doReadSS=function(t){var e=t.row,o=t.col,n=t.endRow,s=t.endCol,r=t.hasBlank,i=void 0!==r&&r,a=null,l=this.getAdditionRange({row:e,col:o,endRow:n,endCol:s}),c=this.sheet;return e&&o?n||s?(a=c.getRange(e,o,l.rows,l.colums).getValues(),i?a:this._blankRowDel(a)):(a=c.getRange(e,o,l.rows,l.colums).getValues())[0][0]:a},t.prototype.getAdditionRange=function(t){var e=t.row,o=t.col,n=t.endRow,s=t.endCol,r={rows:1,colums:1};return n&&(r.rows=n-e+1),s&&(r.colums=s-o+1),r},t.prototype.copySheet=function(t){if(t){var e=this.book;this.sheet.copyTo(e).setName(t)}},t.prototype.setPullDown=function(t){var e=t.row,o=t.col,n=t.valueArray,s=t.initValue,r=this.sheet.getRange(e,o),i=SpreadsheetApp.newDataValidation().requireValueInList(n).build();(r.setDataValidation(i),s)&&(n.find((function(t){return t===s}))&&r.setValue(s))},t.prototype.delRow=function(t){var e=t.row,o=t.col,n=t.endRow,s=t.endCol,r=this.getAdditionRange({row:e,col:o,endRow:n,endCol:s});this.sheet.getRange(e,o,r.rows,r.colums).deleteCells(SpreadsheetApp.Dimension.ROWS)},t.prototype.changeCellBackGroundColor=function(t){var e=t.color,o=t.row,n=t.col,s=t.endRow,r=t.endCol,i=this.getAdditionRange({row:o,col:n,endRow:s,endCol:r});this.sheet.getRange(o,n,i.rows,i.colums).setBackground(e)},t.prototype.changeCellBackGroundColorVerString=function(t,e){if(!e)return null;this.sheet.getRange(e).setBackground(t)},t.prototype.addData=function(t){this.sheet.appendRow(t)},t.prototype.removeDuplicates=function(t){var e=t.row,o=t.col,n=t.endRow,s=t.endCol,r=this.getAdditionRange({row:e,col:o,endRow:n,endCol:s}),i=this.sheet;e&&o&&i.getRange(e,o,r.rows,r.colums).removeDuplicates()},t.prototype.removeDuplicatesVerString=function(t){t&&this.sheet.getRange(t).removeDuplicates()},t}(),s=function(){function t(t){this.baseUrl=t,this.sgsLog=new n(e,"fetch log")}return t.prototype.doGet=function(t){var e=t.url,o=t.options,n=null!=e?e:this.baseUrl;if(n&&""!==n){this.sgsLog.addData([String(new Date),n]);var s=UrlFetchApp.fetch(n,o);if(s.getContentText()){var r=JSON.parse(s.getContentText());return this.sgsLog.addData(["",JSON.stringify(r)]),r}return s.getContentText()?void 0:null}},t.prototype.doPost=function(t){var e=t.url,o=t.options,n=null!=e?e:this.baseUrl;if(n&&""!==n){this.sgsLog.addData([String(new Date),n,JSON.stringify(o)]);var s=UrlFetchApp.fetch(n,o);if(s.getContentText()){var r=JSON.parse(s.getContentText());return this.sgsLog.addData(["",JSON.stringify(r)]),r}return s.getContentText()?void 0:null}},t}(),r=new(function(){function t(){var t="https://api.line.me/v2/bot/message";this.urlData={reply:"".concat(t,"/reply"),push:"".concat(t,"/push"),profile:"https://api.line.me/v2/bot/profile/"},this.sgsGetMessage=new n(e,"Chat"),this.fetchFunction=new s(""),this.HEADERS={"Content-Type":"application/json; charset=UTF-8",Authorization:"Bearer qL979rNKdcF0Uryh2i+2fImy1wOxReHn0euxp6SX7MxzQC5/pfESidQw+KyIoZQYnefxZ+FEWNCqwOOsvrl/kTLbiycZ10YLG3W7OaJ7gVeT6ouXwbKgBjXyjJAoFjj3CoNeuy7DHRNNvKCQCmh29gdB04t89/1O/w1cDnyilFU="}}return t.prototype.__checkMessagesUndefined=function(t){for(var e=0;e<t.length;e++)if(void 0===t[e])return!0;return!1},t.prototype.__getUserData=function(t){if(t){var e={method:"GET",headers:this.HEADERS},o=this.urlData.profile+"/"+t,n=this.fetchFunction.doGet({url:o,options:e});if(n.userId)return{userId:n.userId,name:n.displayName}}},t.prototype.checkMessageAndPost=function(t){var e=JSON.parse(t.postData.contents).events[0];this.sgsGetMessage.addData(["",JSON.stringify(e)]),"text"===e.message.type&&e.source.userId&&this.reply(t,[{type:"text",text:"".concat(e.source.userId)}])},t.prototype.reply=function(t,e){if(!this.__checkMessagesUndefined(e)){var o={replyToken:JSON.parse(t.postData.contents).events[0].replyToken,messages:e},n={method:"POST",headers:this.HEADERS,payload:JSON.stringify(o)};this.fetchFunction.doPost({url:this.urlData.reply,options:n})}},t.prototype.post=function(t,e){if(!this.__checkMessagesUndefined(e)){var o={to:t,messages:e},n={method:"POST",headers:this.HEADERS,payload:JSON.stringify(o)};this.fetchFunction.doPost({url:this.urlData.push,options:n})}},t}());t.g.doPost=function(t){r.checkMessageAndPost(t)},t.g.doPostMessages=function(){r.post("U314639443c254640f3d44313e524080a",[{type:"text",text:"LINE APP GASから返信 POST"}])}})();