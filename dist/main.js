function testApp(){}function originEdit(e){}function doPost(e){}(()=>{"use strict";var e={d:(t,s)=>{for(var o in s)e.o(s,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:s[o]})}};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),e.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var t={};e.r(t),e.d(t,{gA:()=>s,sK:()=>o,rd:()=>i,kv:()=>a,kH:()=>r,wA:()=>n});const s="",o="https://docs.google.com/spreadsheets/d/1FbBBgh6SXu11JaeQUHDcQWS6jD1FA0nS5QLwDFKRpn8/edit",n="test",i=1,a=2,r=26;class l{constructor(e,t){this.book=SpreadsheetApp.openByUrl(e),this.sheetName=t,this.sheet=this.book.getSheetByName(t)}doGetLastRow(e,t){if(!e&&!t)return;return this.sheet.getRange(e,t).getNextDataCell(SpreadsheetApp.Direction.DOWN).getRow()}doGetLastCol(e,t){if(!e||!t)return;return this.sheet.getRange(e,t).getNextDataCell(SpreadsheetApp.Direction.NEXT).getColumn()}doWriteSS(e,t,s){if(!t||!s)return;e||(e="");this.sheet.getRange(t,s).setValue(e)}doReadSSVerString(e){let t=null;if(!e)return t;return t=this.sheet.getRange(e).getValues(),t}doReadSS(e,t,s,o){let n=null;const i=this.getAdditionRange(e,t,s,o),a=this.sheet;return e&&t?s||o?(n=a.getRange(e,t,i.rows,i.colums).getValues(),n):(n=a.getRange(e,t,i.rows,i.colums).getValues(),n[0][0]):n}getAdditionRange(e,t,s,o){const n={rows:1,colums:1};return s&&(n.rows=s-e+1),o&&(n.colums=o-t+1),n}copySheet(e){if(!e)return;const t=this.book;this.sheet.copyTo(t).setName(e)}setPullDown(e,t,s,o){const n=this.sheet.getRange(e,t),i=SpreadsheetApp.newDataValidation().requireValueInList(s).build();if(n.setDataValidation(i),o){s.find((e=>e===o))&&n.setValue(o)}}delRow(e,t,s,o){const n=this.getAdditionRange(e,t,s,o);this.sheet.getRange(e,t,n.rows,n.colums).deleteCells(SpreadsheetApp.Dimension.ROWS)}changeCellBackGroundColor(e,t,s,o,n){const i=this.getAdditionRange(t,s,o,n);this.sheet.getRange(t,s,i.rows,i.colums).setBackground(e)}changeCellBackGroundColorVerString(e,t){if(!t)return null;this.sheet.getRange(t).setBackground(e)}}class h{constructor(e){this.gasApp=e,this.redColorRanges=[],this.yellowColorRanges=[],this.blueColorRanges=[],this.lastRow=this.gasApp.doGetLastRow(1,i),this.lastCol=this.gasApp.doGetLastCol(1,r),this.ssData=this.getAllData()}getAllData(){return this.gasApp.doReadSS(1,i,this.lastRow,this.lastCol)}changeColor(){this.yellowColorRanges.forEach((e=>{this.gasApp.changeCellBackGroundColor("#f1d553",e.row,e.col)})),this.redColorRanges.forEach((e=>{this.gasApp.changeCellBackGroundColor("#e14e30",e.row,e.col)})),this.blueColorRanges.forEach((e=>{this.gasApp.changeCellBackGroundColor("#5a86ea",e.row,e.col)}))}doing(){this.yellowColorRanges.push({row:1,col:a}),this.yellowColorRanges.push({row:2,col:a}),this.yellowColorRanges.push({row:3,col:a}),this.changeColor()}}class g{constructor(e,t,s){this.app=e,this.event=t,this.range=this.event.range,this.value=this.event.value,this.oldValue=this.event.oldValue,this.nowSheetName=s,this.sheetBranch(s)}sheetBranch(e){if(e===t.SHEET_FUNCTION_LIST)this.eventSheet()}eventSheet(){if(this.range.columnStart===i)this.app.checkCallFunction(this.range.rowStart);this.range.rowStart}}var c=new class{constructor(){this.running=!1}init(){!0!==this.running&&(this.running=!0)}fix(){this.running=!1}test(){this.init();const e=new l(o,n);new h(e).doing(),this.fix()}};e.g.testApp=function(){c.test()},e.g.originEdit=function(e){var t=SpreadsheetApp.getActiveSpreadsheet().getName(),o=SpreadsheetApp.getActiveSpreadsheet().getSheetName();if(t===s)new g(c,e,o)},e.g.doPost=function(e){SpreadsheetApp.getActive().getActiveSheet().appendRow([new Date,e.postData.contents])}})();