(()=>{"use strict";var e={626:(e,t,A)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CreateDataMessage=void 0;var _=A(353),o=function(){this.log=new _.Log("CreateDataMessage")};t.CreateDataMessage=o},920:(e,t,A)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GASController=void 0;var _=A(972),o=A(353),n=A(482),r=function(){function e(){this.log=new o.Log("GASController"),this.paySgs=new n.SimpleGoogleSpreadsheet(_.BOOK_URL,"発生支払い"),this.dataSgs=new n.SimpleGoogleSpreadsheet(_.BOOK_URL,"残高計算"),this.statusSgs=new n.SimpleGoogleSpreadsheet(_.BOOK_URL,"status")}return e.prototype.getStatus=function(){return this.statusSgs.doReadSS({row:1,col:_.COL_A})},e.prototype.setStatus=function(e){this.statusSgs.doWriteSS(e,1,_.COL_A)},e}();t.GASController=r},848:(e,t,A)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LineApp=void 0;var _=A(806),o=A(204),n=A(783),r=A(353),C=A(626),i=A(920),s=function(){function e(){this.urlData={reply:"https://api.line.me/v2/bot/message/reply",push:"https://api.line.me/v2/bot/message/push",profile:"https://api.line.me/v2/bot/profile/"},this.log=new r.Log("LineApp"),this.fetchFunction=new n.FetchFunction,this.gasController=new i.GASController,this.createMessage=new C.CreateDataMessage,this.HEADERS={"Content-Type":"application/json; charset=UTF-8",Authorization:"Bearer "+o.CHANNEL_ACCESS_TOKEN}}return e.prototype.__checkMessagesUndefined=function(e){for(var t=0;t<e.length;t++)if(void 0===e[t])return!0;return!1},e.prototype.__getUserData=function(e){if(e){var t={method:"get",headers:this.HEADERS},A=this.urlData.profile+"/"+e,_=this.fetchFunction.doGet({url:A,options:t});if(_.userId)return{userId:_.userId,name:_.displayName}}},e.prototype.__switchMessage=function(e){if("メニュー"===e)return[{type:"text",text:"以下のメッセージをしてください。\nメニュー1\nメニュー2\nメニュー3"}];var t=e.split("\n"),A=Number(t[0]);return isNaN(A)?[_.MESSAGE.failedAddPay]:[_.MESSAGE.successAddPay]},e.prototype.checkMessageAndPost=function(e){var t=JSON.parse(e.postData.contents).events[0];if(this.log.push([t]),"text"===t.message.type&&t.source.userId){var A=this.__switchMessage(t.message.text);this.reply(e,A)}},e.prototype.reply=function(e,t){if(!this.__checkMessagesUndefined(t)){var A={replyToken:JSON.parse(e.postData.contents).events[0].replyToken,messages:t},_={method:"post",headers:this.HEADERS,payload:JSON.stringify(A)};this.fetchFunction.doPost({url:this.urlData.reply,options:_})}},e.prototype.post=function(e,t){if(!this.__checkMessagesUndefined(t)){var A={to:e,messages:t},_={method:"post",headers:this.HEADERS,payload:JSON.stringify(A)};this.fetchFunction.doPost({url:this.urlData.push,options:_})}},e}();t.LineApp=s},353:function(e,t,A){var _=this&&this.__spreadArray||function(e,t,A){if(A||2===arguments.length)for(var _,o=0,n=t.length;o<n;o++)!_&&o in t||(_||(_=Array.prototype.slice.call(t,0,o)),_[o]=t[o]);return e.concat(_||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.Log=void 0;var o=A(972),n=A(482),r=function(){function e(e){this.appName=e,this.sgs=new n.SimpleGoogleSpreadsheet(o.BOOK_URL,"log")}return e.prototype.push=function(e){if(0!==e.length){var t=e.map((function(e){return JSON.stringify(e)}));this.sgs.addData(_([this.appName,String(new Date)],t,!0))}},e}();t.Log=r},482:(e,t,A)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SimpleGoogleSpreadsheet=void 0;var _=A(972),o=function(){function e(e,t){this.book=SpreadsheetApp.openByUrl(e),this.sheetName=t,this.sheet=this.book.getSheetByName(t)}return e.prototype._isBlankRow=function(e){var t=!0;return e.forEach((function(e){""!==e&&(t=!1)})),t},e.prototype._blankRowDel=function(e){var t=this;return e?e.filter((function(e){return!t._isBlankRow(e)})):null},e.prototype._blankColDel=function(e){return e?e.filter((function(e){return""!==e})):null},e.prototype.doGetLastRow=function(e,t){if(!(e<1&&t<1)){var A=_.COL_LIST[t-1],o=this.doReadSSVerString("".concat(A).concat(e,":").concat(A,"1000"));if(o&&o.length<2)return e+1;var n=this.sheet;return n&&n.getRange(e,t).getNextDataCell(SpreadsheetApp.Direction.DOWN).getRow()+1}},e.prototype.doGetLastCol=function(e,t){if(!(e<1&&t<1)){var A=_.COL_LIST[t-1],o=_.COL_LIST[_.COL_LIST.length-1],n=this.doReadSSVerString("".concat(A).concat(e,":").concat(o).concat(e)),r=n&&this._blankColDel(n[0]);if(r&&r.length<2)return t+1;var C=this.sheet;return C&&C.getRange(e,t).getNextDataCell(SpreadsheetApp.Direction.NEXT).getColumn()+1}},e.prototype.doWriteSS=function(e,t,A){if(t&&A){e||(e="");var _=this.sheet;null==_||_.getRange(t,A).setValue(e)}},e.prototype.doReadSSVerString=function(e,t){void 0===t&&(t=!1);var A=null;if(!e)return A;var _=this.sheet;return A=null==_?void 0:_.getRange(e).getValues(),t?A:this._blankRowDel(A)},e.prototype.doReadSS=function(e){var t=e.row,A=e.col,_=e.endRow,o=e.endCol,n=e.hasBlank,r=void 0!==n&&n,C=null,i=this.getAdditionRange({row:t,col:A,endRow:_,endCol:o}),s=this.sheet;return t&&A?_||o?(C=null==s?void 0:s.getRange(t,A,i.rows,i.colums).getValues(),r?C:this._blankRowDel(C)):(C=null==s?void 0:s.getRange(t,A,i.rows,i.colums).getValues())&&C[0][0]:C},e.prototype.getAdditionRange=function(e){var t=e.row,A=e.col,_=e.endRow,o=e.endCol,n={rows:1,colums:1};return _&&(n.rows=_-t+1),o&&(n.colums=o-A+1),n},e.prototype.copySheet=function(e){if(e){var t=this.book,A=this.sheet,_=null==A?void 0:A.copyTo(t);null==_||_.setName(e)}},e.prototype.setPullDown=function(e){var t=e.row,A=e.col,_=e.valueArray,o=e.initValue,n=this.sheet,r=null==n?void 0:n.getRange(t,A),C=SpreadsheetApp.newDataValidation().requireValueInList(_).build();(null==r||r.setDataValidation(C),o)&&(_.find((function(e){return e===o}))&&(null==r||r.setValue(o)))},e.prototype.delRow=function(e){var t=e.row,A=e.col,_=e.endRow,o=e.endCol,n=this.getAdditionRange({row:t,col:A,endRow:_,endCol:o}),r=this.sheet,C=null==r?void 0:r.getRange(t,A,n.rows,n.colums);null==C||C.deleteCells(SpreadsheetApp.Dimension.ROWS)},e.prototype.changeCellBackGroundColor=function(e){var t=e.color,A=e.row,_=e.col,o=e.endRow,n=e.endCol,r=this.getAdditionRange({row:A,col:_,endRow:o,endCol:n}),C=this.sheet,i=null==C?void 0:C.getRange(A,_,r.rows,r.colums);null==i||i.setBackground(t)},e.prototype.changeCellBackGroundColorVerString=function(e,t){if(!t)return null;var A=this.sheet,_=null==A?void 0:A.getRange(t);null==_||_.setBackground(e)},e.prototype.addData=function(e){var t=this.sheet;null==t||t.appendRow(e)},e.prototype.removeDuplicates=function(e){var t=e.row,A=e.col,_=e.endRow,o=e.endCol,n=this.getAdditionRange({row:t,col:A,endRow:_,endCol:o}),r=this.sheet;if(t&&A)if(_||o){var C=null==r?void 0:r.getRange(t,A,n.rows,n.colums);null==C||C.removeDuplicates()}else{var i=null==r?void 0:r.getRange(t,A,n.rows,n.colums);null==i||i.removeDuplicates()}},e.prototype.removeDuplicatesVerString=function(e){if(e){var t=this.sheet,A=null==t?void 0:t.getRange(e);null==A||A.removeDuplicates()}},e}();t.SimpleGoogleSpreadsheet=o},783:(e,t,A)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FetchFunction=void 0;var _=A(353),o=function(){function e(){this.log=new _.Log("FetchFunction")}return e.prototype.doGet=function(e){var t=e.url,A=e.options;if(t&&""!==t){this.log.push([t]);var _=A?UrlFetchApp.fetch(t,A):UrlFetchApp.fetch(t);if(_.getContentText()){var o=JSON.parse(_.getContentText());return this.log.push([JSON.stringify(o)]),o}return _.getContentText()?void 0:null}},e.prototype.doPost=function(e){var t=e.url,A=e.options;if(t&&""!==t){this.log.push([t,JSON.stringify(A)]);var _=A?UrlFetchApp.fetch(t,A):UrlFetchApp.fetch(t);if(_.getContentText()){var o=JSON.parse(_.getContentText());return this.log.push(["",JSON.stringify(o)]),o}return _.getContentText()?void 0:null}},e}();t.FetchFunction=o},972:(e,t,A)=>{var _;Object.defineProperty(t,"__esModule",{value:!0}),t.COL_AU=t.COL_AT=t.COL_AS=t.COL_AR=t.COL_AQ=t.COL_AP=t.COL_AO=t.COL_AN=t.COL_AM=t.COL_AL=t.COL_AK=t.COL_AJ=t.COL_AI=t.COL_AH=t.COL_AG=t.COL_AF=t.COL_AE=t.COL_AD=t.COL_AC=t.COL_AB=t.COL_AA=t.COL_Z=t.COL_Y=t.COL_X=t.COL_W=t.COL_V=t.COL_U=t.COL_T=t.COL_S=t.COL_R=t.COL_Q=t.COL_P=t.COL_O=t.COL_N=t.COL_M=t.COL_L=t.COL_K=t.COL_J=t.COL_I=t.COL_H=t.COL_G=t.COL_F=t.COL_E=t.COL_D=t.COL_C=t.COL_B=t.COL_A=t.SHEET_FUNCTION_LIST=t.BOOK_URL=t.BOOK_NAME=void 0,t.ARRAY_COL_AS=t.ARRAY_COL_AR=t.ARRAY_COL_AQ=t.ARRAY_COL_AP=t.ARRAY_COL_AO=t.ARRAY_COL_AN=t.ARRAY_COL_AM=t.ARRAY_COL_AL=t.ARRAY_COL_AK=t.ARRAY_COL_AJ=t.ARRAY_COL_AI=t.ARRAY_COL_AH=t.ARRAY_COL_AG=t.ARRAY_COL_AF=t.ARRAY_COL_AE=t.ARRAY_COL_AD=t.ARRAY_COL_AC=t.ARRAY_COL_AB=t.ARRAY_COL_AA=t.ARRAY_COL_Z=t.ARRAY_COL_Y=t.ARRAY_COL_X=t.ARRAY_COL_W=t.ARRAY_COL_V=t.ARRAY_COL_U=t.ARRAY_COL_T=t.ARRAY_COL_S=t.ARRAY_COL_R=t.ARRAY_COL_Q=t.ARRAY_COL_P=t.ARRAY_COL_O=t.ARRAY_COL_N=t.ARRAY_COL_M=t.ARRAY_COL_L=t.ARRAY_COL_K=t.ARRAY_COL_J=t.ARRAY_COL_I=t.ARRAY_COL_H=t.ARRAY_COL_G=t.ARRAY_COL_F=t.ARRAY_COL_E=t.ARRAY_COL_D=t.ARRAY_COL_C=t.ARRAY_COL_B=t.ARRAY_COL_A=t.COL_AZ=t.COL_AY=t.COL_AX=t.COL_AW=t.COL_AV=void 0,t.COL_LIST=t.ARRAY_COL_AZ=t.ARRAY_COL_AY=t.ARRAY_COL_AX=t.ARRAY_COL_AW=t.ARRAY_COL_AV=t.ARRAY_COL_AU=t.ARRAY_COL_AT=void 0,t.BOOK_NAME="",t.BOOK_URL=null!==(_="MISSING_ENV_VAR".CAL_BOOK_URL)&&void 0!==_?_:"",t.SHEET_FUNCTION_LIST=[],t.COL_A=1,t.COL_B=2,t.COL_C=3,t.COL_D=4,t.COL_E=5,t.COL_F=6,t.COL_G=7,t.COL_H=8,t.COL_I=9,t.COL_J=10,t.COL_K=11,t.COL_L=12,t.COL_M=13,t.COL_N=14,t.COL_O=15,t.COL_P=16,t.COL_Q=17,t.COL_R=18,t.COL_S=19,t.COL_T=20,t.COL_U=21,t.COL_V=22,t.COL_W=23,t.COL_X=24,t.COL_Y=25,t.COL_Z=26,t.COL_AA=27,t.COL_AB=28,t.COL_AC=29,t.COL_AD=30,t.COL_AE=31,t.COL_AF=32,t.COL_AG=33,t.COL_AH=34,t.COL_AI=35,t.COL_AJ=36,t.COL_AK=37,t.COL_AL=38,t.COL_AM=39,t.COL_AN=40,t.COL_AO=41,t.COL_AP=42,t.COL_AQ=43,t.COL_AR=44,t.COL_AS=45,t.COL_AT=46,t.COL_AU=47,t.COL_AV=48,t.COL_AW=49,t.COL_AX=50,t.COL_AY=51,t.COL_AZ=52,t.ARRAY_COL_A=0,t.ARRAY_COL_B=1,t.ARRAY_COL_C=2,t.ARRAY_COL_D=3,t.ARRAY_COL_E=4,t.ARRAY_COL_F=5,t.ARRAY_COL_G=6,t.ARRAY_COL_H=7,t.ARRAY_COL_I=8,t.ARRAY_COL_J=9,t.ARRAY_COL_K=10,t.ARRAY_COL_L=11,t.ARRAY_COL_M=12,t.ARRAY_COL_N=13,t.ARRAY_COL_O=14,t.ARRAY_COL_P=15,t.ARRAY_COL_Q=16,t.ARRAY_COL_R=17,t.ARRAY_COL_S=18,t.ARRAY_COL_T=19,t.ARRAY_COL_U=20,t.ARRAY_COL_V=21,t.ARRAY_COL_W=22,t.ARRAY_COL_X=23,t.ARRAY_COL_Y=24,t.ARRAY_COL_Z=25,t.ARRAY_COL_AA=26,t.ARRAY_COL_AB=27,t.ARRAY_COL_AC=28,t.ARRAY_COL_AD=29,t.ARRAY_COL_AE=30,t.ARRAY_COL_AF=31,t.ARRAY_COL_AG=32,t.ARRAY_COL_AH=33,t.ARRAY_COL_AI=34,t.ARRAY_COL_AJ=35,t.ARRAY_COL_AK=36,t.ARRAY_COL_AL=37,t.ARRAY_COL_AM=38,t.ARRAY_COL_AN=39,t.ARRAY_COL_AO=40,t.ARRAY_COL_AP=41,t.ARRAY_COL_AQ=42,t.ARRAY_COL_AR=43,t.ARRAY_COL_AS=44,t.ARRAY_COL_AT=45,t.ARRAY_COL_AU=46,t.ARRAY_COL_AV=47,t.ARRAY_COL_AW=48,t.ARRAY_COL_AX=49,t.ARRAY_COL_AY=50,t.ARRAY_COL_AZ=51,t.COL_LIST=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","AA","AB","AC","AD","AE","AF","AG","AH","AI","AJ","AK","AL","AM","AN","AO","AP","AQ","AR","AS","AT","AU","AV","AW","AX","AY","AZ","BA","BB","BC","BD","BE","BF","BG","BH","BI","BJ","BK","BL","BM","BN","BO","BP","BQ","BR","BS","BT","BU","BV","BW","BX","BY","BZ","CA","CB","CC","CD","CE","CF","CG","CH","CI","CJ","CK","CL","CM","CN","CO","CP","CQ","CR","CS","CT","CU","CV","CW","CX","CY","CZ"]},806:(e,t,A)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MESSAGE=void 0,t.MESSAGE={successAddPay:{type:"text",text:"支出に追加しました。"},failedAddPay:{type:"text",text:"支出の追加に失敗しました。\n数字で入力ください。"}}},204:(e,t,A)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MY_ACCOUNT_ID=t.CHANNEL_ACCESS_TOKEN=void 0,t.CHANNEL_ACCESS_TOKEN="MISSING_ENV_VAR".CAL_CHANNEL_ACCESS_TOKEN,t.MY_ACCOUNT_ID="MISSING_ENV_VAR".CAL_MY_ACCOUNT_ID}},t={};function A(_){var o=t[_];if(void 0!==o)return o.exports;var n=t[_]={exports:{}};return e[_].call(n.exports,n,n.exports,A),n.exports}A.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}();A(204),new(A(848).LineApp)})();